{% comment %}
Featured Collection section
- Choose a collection in the section settings
- Configure number of products, columns, show vendor/price, and a heading
{% endcomment %}

<section id="featured-collection-{{ section.id }}" class="featured-collection-section">
    {% assign collection = collections[section.settings.collection] %}
    {% if collection == nil %}
        <div class="featured-collection-empty">
            <p>Please select a collection in the section settings to display products.</p>
        </div>
    {% else %}
        <div class="featured-collection__header">
            {% if section.settings.heading != blank %}
                <h2 class="featured-collection__title">{{ section.settings.heading }}</h2>
            {% endif %}
            {% if section.settings.show_view_all %}
                <a href="{{ collection.url }}" class="featured-collection__view-all">{{ section.settings.view_all_text | default: 'View all' }}</a>
            {% endif %}
        </div>

        <div class="featured-collection__products grid grid--cols-{{ section.settings.columns }}">
            {% assign limit = section.settings.products_to_show | default: 4 %}
            {% for product in collection.products limit: limit %}
                {% assign first_variant = product.selected_or_first_available_variant %}
                <article class="product-card">
                    <a href="{{ product.url }}" class="product-card__image-link">
                        {% if product.featured_image %}
                            <img
                                src="{{ product.featured_image | img_url: section.settings.image_size }}"
                                alt="{{ product.featured_image.alt | escape }}"
                                class="product-card__image"
                            />
                        {% else %}
                            <div class="product-card__image-placeholder" aria-hidden="true"></div>
                        {% endif %}
                    </a>

                    <div class="product-card__content">
                        <a href="{{ product.url }}" class="product-card__title">{{ product.title }}</a>

                        {% if section.settings.show_vendor and product.vendor != blank %}
                            <div class="product-card__vendor">{{ product.vendor }}</div>
                        {% endif %}

                        {% if section.settings.show_price %}
                            <div class="product-card__price">
                                {% if first_variant.compare_at_price and first_variant.compare_at_price > first_variant.price %}
                                    <span class="product-card__price--sale">{{ first_variant.price | money }}</span>
                                    <span class="product-card__price--compare">{{ first_variant.compare_at_price | money }}</span>
                                {% else %}
                                    <span class="product-card__price--regular">{{ first_variant.price | money }}</span>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </article>
            {% endfor %}
        </div>
    {% endif %}
</section>

{% schema %}
{
    "name": "Featured collection",
    "settings": [
        {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Featured collection"
        },
        {
            "type": "collection",
            "id": "collection",
            "label": "Collection"
        },
        {
            "type": "range",
            "id": "products_to_show",
            "label": "Number of products to show",
            "min": 1,
            "max": 12,
            "step": 1,
            "default": 4
        },
        {
            "type": "select",
            "id": "columns",
            "label": "Columns",
            "options": [
                { "value": "2", "label": "2" },
                { "value": "3", "label": "3" },
                { "value": "4", "label": "4" },
                { "value": "5", "label": "5" }
            ],
            "default": "4"
        },
        {
            "type": "select",
            "id": "image_size",
            "label": "Image size",
            "options": [
                { "value": "300x", "label": "Small" },
                { "value": "600x", "label": "Medium" },
                { "value": "900x", "label": "Large" }
            ],
            "default": "600x"
        },
        {
            "type": "checkbox",
            "id": "show_vendor",
            "label": "Show vendor",
            "default": false
        },
        {
            "type": "checkbox",
            "id": "show_price",
            "label": "Show price",
            "default": true
        },
        {
            "type": "checkbox",
            "id": "show_view_all",
            "label": "Show 'View all' link",
            "default": true
        },
        {
            "type": "text",
            "id": "view_all_text",
            "label": "View all text",
            "default": "View all"
        }
    ],
    "presets": [
        {
            "name": "Featured collection",
            "category": "General"
        }
    ]
}
{% endschema %}